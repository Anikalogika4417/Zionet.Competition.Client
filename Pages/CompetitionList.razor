@page "/CompetitionList"
@using ClientEntity
@inject DataService data
@inject HttpClient Http

<PageTitle>Competition List</PageTitle>

<h1>Competitions:</h1>

<DataGrid TItem="MCompetition"
          Data="@ListOfCompetitions"
          Responsive>
<DataGridCommandColumn />
    <DataGridColumn Field="@nameof(MCompetition.competition_name)" Caption="Name" Sortable="true" />
    <DataGridColumn Field="@nameof(MCompetition.competition_start)" Caption="Start" Sortable="true" />
    <DataGridColumn Field="@nameof(MCompetition.competition_end)" Caption="End" Sortable="true" />
    <DataGridColumn Field="@nameof(MCompetition.task_quantity)" Caption="Quantity of tasks" Sortable="true" />
</DataGrid>


@code
{
    List<MCompetition> ListOfCompetitions = new List<MCompetition>();
    MCompetition choosenCompetition = new MCompetition();
    private MCompetition selectedCompetition;
    
    @*----------------Downloading all competitions----------------*@
    protected override async Task OnInitializedAsync()
    {
        ListOfCompetitions = await data.GetCompetitions();
        choosenCompetition = null;
        await base.OnInitializedAsync();
    }

    @*----------------Changing choosen competition by radio button----------------*@
    private void OnListCompetitionChange(ChangeEventArgs e){
        if(e.Value != ""){
            var IndexSelectedCompetition = ListOfCompetitions.FindIndex(p => p.id == int.Parse(e.Value.ToString()));
            choosenCompetition = ListOfCompetitions[IndexSelectedCompetition];
            Console.WriteLine(choosenCompetition.competition_name);
        }
    }
}